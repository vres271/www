<div class="settings-container">
  <h1>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–≥—Ä—ã</h1>

  <!-- –†–∞–∑–¥–µ–ª –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∏–≥—Ä–æ–∫–∞ -->
  <div class="settings-section">
    <div class="section-header">
      <h2>–ò–≥—Ä–æ–∫–∏</h2>
      <button class="btn btn-primary" (click)="toggleAddPlayer()">
        {{ showAddPlayer ? '‚úï –û—Ç–º–µ–Ω–∞' : '+ –î–æ–±–∞–≤–∏—Ç—å –∏–≥—Ä–æ–∫–∞' }}
      </button>
    </div>

    <!-- –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∏–≥—Ä–æ–∫–∞ -->
    <div *ngIf="showAddPlayer" class="add-player-form card">
      <div class="form-group">
        <label class="form-label">–ò–º—è –∏–≥—Ä–æ–∫–∞</label>
        <input 
          type="text" 
          class="form-control" 
          [(ngModel)]="editingPlayerName"
          placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–º—è"
        >
      </div>

      <div class="form-group">
        <label class="form-label">–ì–æ—Ä–æ–¥</label>
        <input 
          type="text" 
          class="form-control" 
          [(ngModel)]="editingPlayerCity"
          placeholder="–í–≤–µ–¥–∏—Ç–µ –≥–æ—Ä–æ–¥"
        >
      </div>

      <div class="form-group">
        <label class="form-label">–§–æ—Ç–æ –∏–≥—Ä–æ–∫–∞ (–º–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ)</label>
        <input 
          type="file" 
          class="form-control file-input" 
          (change)="onPhotoSelected($event)"
          accept="image/*"
          multiple
        >
      </div>

      <!-- –ü—Ä–µ–≤—å—é —Ñ–æ—Ç–æ -->
      <div *ngIf="editingPlayerPhotosPreviews.length > 0" class="photos-preview-grid">
        <div *ngFor="let preview of editingPlayerPhotosPreviews; let i = index" class="photo-preview-item">
          <img [src]="preview" alt="–ü—Ä–µ–≤—å—é —Ñ–æ—Ç–æ">
          <button 
            type="button"
            class="btn-remove-preview" 
            (click)="removePhotoPreview(i)"
            title="–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ —Ñ–æ—Ç–æ"
          >
            ‚úï
          </button>
        </div>
      </div>

      <button class="btn btn-primary" (click)="onAddPlayer()">
        –î–æ–±–∞–≤–∏—Ç—å –∏–≥—Ä–æ–∫–∞
      </button>
    </div>

    <!-- –°–ø–∏—Å–æ–∫ –∏–≥—Ä–æ–∫–æ–≤ -->
    <div class="players-list">
      <div *ngIf="players.length === 0" class="empty-state">
        <p>–ò–≥—Ä–æ–∫–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤–æ–≥–æ –∏–≥—Ä–æ–∫–∞!</p>
      </div>

      <div *ngFor="let player of players" class="player-card card">
        <!-- –ü—Ä–æ—Å–º–æ—Ç—Ä –∏–≥—Ä–æ–∫–∞ -->
        <div *ngIf="!isEditing(player.id)" class="player-view">
          <div class="player-header">
            <div class="player-info">
              <h3>{{ player.name }}</h3>
              <span class="player-city">{{ player.city }}</span>
              <span class="photo-count">{{ player.photoIds?.length || 0 }} —Ñ–æ—Ç–æ</span>
            </div>
            <div class="player-actions">
              <button 
                class="btn btn-secondary btn-sm" 
                (click)="startEditPlayer(player)"
                title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–≥—Ä–æ–∫–∞"
              >
                ‚úéÔ∏è
              </button>
              <button 
                class="btn btn-outline btn-sm" 
                (click)="onDeletePlayer(player.id)"
                title="–£–¥–∞–ª–∏—Ç—å –∏–≥—Ä–æ–∫–∞"
              >
                üóëÔ∏è
              </button>
            </div>
          </div>

          <!-- –§–æ—Ç–æ –≤ —Ä–µ–∂–∏–º–µ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ -->
          <div *ngIf="player.photoIds && player.photoIds.length > 0" class="player-photos-grid">
            <div *ngFor="let photoId of player.photoIds" class="photo-item">
              <img [src]="playerPhotoUrls[photoId]" alt="–§–æ—Ç–æ –∏–≥—Ä–æ–∫–∞">
            </div>
          </div>

          <div *ngIf="!player.photoIds || player.photoIds.length === 0" class="empty-photos">
            <p>–§–æ—Ç–æ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã</p>
          </div>
        </div>

        <!-- –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–≥—Ä–æ–∫–∞ -->
        <div *ngIf="isEditing(player.id)" class="player-edit">
          <div class="form-group">
            <label class="form-label">–ò–º—è –∏–≥—Ä–æ–∫–∞</label>
            <input 
              type="text" 
              class="form-control" 
              [(ngModel)]="editingPlayerName"
            >
          </div>

          <div class="form-group">
            <label class="form-label">–ì–æ—Ä–æ–¥</label>
            <input 
              type="text" 
              class="form-control" 
              [(ngModel)]="editingPlayerCity"
            >
          </div>

          <div class="form-group">
            <label class="form-label">–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ —Ñ–æ—Ç–æ</label>
            <input 
              type="file" 
              class="form-control file-input" 
              (change)="onPhotoSelected($event)"
              accept="image/*"
              multiple
            >
          </div>

          <!-- –ü—Ä–µ–≤—å—é –Ω–æ–≤—ã—Ö —Ñ–æ—Ç–æ -->
          <div *ngIf="editingPlayerPhotosPreviews.length > 0" class="photos-preview-grid">
            <div *ngFor="let preview of editingPlayerPhotosPreviews; let i = index" class="photo-preview-item">
              <img [src]="preview" alt="–ü—Ä–µ–≤—å—é —Ñ–æ—Ç–æ">
              <button 
                type="button"
                class="btn-remove-preview" 
                (click)="removePhotoPreview(i)"
              >
                ‚úï
              </button>
            </div>
          </div>

          <!-- –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ñ–æ—Ç–æ -->
          <div *ngIf="getPlayerPhotos(player.id).length > 0" class="existing-photos">
            <h4>–ó–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ —Ñ–æ—Ç–æ:</h4>
            <div class="player-photos-grid">
              <div *ngFor="let photo of getPlayerPhotos(player.id)" class="photo-item-editable">
                <img [src]="playerPhotoUrls[photo.photoId]" alt="–§–æ—Ç–æ –∏–≥—Ä–æ–∫–∞">
                <button 
                  class="btn-delete-photo" 
                  (click)="deletePhoto(player.id, photo.photoId)"
                  title="–£–¥–∞–ª–∏—Ç—å —Ñ–æ—Ç–æ"
                >
                  üóëÔ∏è
                </button>
              </div>
            </div>
          </div>

          <!-- –ö–Ω–æ–ø–∫–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è -->
          <div class="edit-actions">
            <button class="btn btn-primary" (click)="saveEditPlayer()">
              üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
            </button>
            <button class="btn btn-secondary" (click)="cancelEditPlayer()">
              –û—Ç–º–µ–Ω–∞
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- –†–∞–∑–¥–µ–ª –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ -->
  <div class="settings-section">
    <h2>‚ÑπÔ∏è –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h2>
    <div class="info-card card">
      <h3>–ö–∞–∫ –∏–≥—Ä–∞—Ç—å:</h3>
      <ol>
        <li>–ö–∞–∂–¥—ã–π –∏–≥—Ä–æ–∫ –∑–∞—Ä–∞–Ω–µ–µ –ø—Ä–∏–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ—Ç <strong>–Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–æ–ø—Ä–æ—Å–æ–≤</strong> –¥–ª—è –∑–Ω–∞—Ç–æ–∫–æ–≤ (–≤–Ω–µ —ç—Ç–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è)</li>
        <li>–ö–∞–∂–¥—ã–π –∑–∞–≥—Ä—É–∂–∞–µ—Ç —Å–≤–æ–∏ <strong>–∑–∞–±–∞–≤–Ω—ã–µ —Ñ–æ—Ç–æ</strong> –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (–º–æ–∂–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ)</li>
        <li>–í–æ –≤—Ä–µ–º—è –∏–≥—Ä—ã –≤–µ–¥—É—â–∏–π –≤—Ä–∞—â–∞–µ—Ç "—Ä—É–ª–µ—Ç–∫—É" (–±–∞—Ä–∞–±–∞–Ω)</li>
        <li>–í—ã–±—Ä–∞–Ω–Ω—ã–π –∏–≥—Ä–æ–∫ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —Ç–µ–ª–µ–∑—Ä–∏—Ç–µ–ª–µ–º –∏ –∑–∞–¥–∞–µ—Ç —Å–≤–æ–π –≤–æ–ø—Ä–æ—Å</li>
        <li>–û—Å—Ç–∞–ª—å–Ω—ã–µ –∏–≥—Ä–æ–∫–∏ (–∑–Ω–∞—Ç–æ–∫–∏) —Å–æ–≤–µ—â–∞—é—Ç—Å—è –∏ –¥–∞—é—Ç –æ—Ç–≤–µ—Ç</li>
        <li>–ó–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç –ø–æ–ª—É—á–∞—é—Ç 1 –æ—á–∫–æ</li>
      </ol>
    </div>
  </div>

  <!-- –†–∞–∑–¥–µ–ª —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è -->
  <div class="settings-section">
    <h2>üéÆ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</h2>
    <button class="btn btn-outline" (click)="onResetGame()">
      üîÑ –°–±—Ä–æ—Å–∏—Ç—å –∏–≥—Ä—É –∏ –≤—Å–µ—Ö –∏–≥—Ä–æ–∫–æ–≤
    </button>
  </div>
</div>
